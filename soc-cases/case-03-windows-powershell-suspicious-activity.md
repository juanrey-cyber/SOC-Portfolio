# SOC Case 03 – Suspicious PowerShell Activity on Windows Endpoint

## Purpose of This Case

This case demonstrates investigation and decision-making for suspicious PowerShell activity on a Windows endpoint.
The focus is on EDR-style thinking: process execution, command-line analysis, attacker intent, and escalation decisions.

This scenario reflects common SOC alerts generated by EDR platforms such as Microsoft Defender, CrowdStrike, or SentinelOne.

---

## Incident Summary

- Incident Type: Suspicious PowerShell Execution
- Operating System: Windows
- Detection Source: EDR-style alert (simulated)
- Execution Context: User-level process
- Command-Line Activity: Obfuscated PowerShell execution
- Initial Alert Type: Suspicious scripting behavior

---

## Detection

The activity was detected due to PowerShell being executed with suspicious command-line arguments commonly associated with malicious activity.

Indicators included:
- Use of PowerShell with execution flags
- Encoded or obfuscated command content
- Non-interactive execution
- Execution outside normal user behavior patterns

Example command-line pattern observed:
powershell.exe -ExecutionPolicy Bypass -NoProfile -EncodedCommand <base64>

---

## Investigation

### Process Analysis

Key observations:
- Parent process was a user-initiated application (not a system process)
- PowerShell executed in a non-interactive context
- No legitimate administrative task correlated with execution time
- Command-line flags indicate intent to bypass security controls

### Behavioral Indicators

Suspicious behaviors identified:
- ExecutionPolicy bypass
- Use of encoded command content
- Absence of signed scripts
- No associated legitimate IT activity

---

## Adversary Behavior Assessment

This activity suggests an attempt to:
- Execute malicious scripts stealthily
- Evade detection mechanisms
- Deliver or execute a payload without user awareness

Potential attacker objectives:
- Initial access execution
- Payload delivery
- Post-exploitation activity

---

## MITRE ATT&CK Mapping

- T1059.001 – Command and Scripting Interpreter: PowerShell
- T1027 – Obfuscated/Compressed Files and Information

---

## Severity & Confidence Assessment

### Severity: MEDIUM

Rationale:
- PowerShell abuse is a high-risk attack vector
- No confirmed malware execution observed
- No persistence or lateral movement detected
- Single endpoint affected

### Confidence: MEDIUM to HIGH

Rationale:
- Command-line indicators strongly suggest malicious intent
- Lack of business justification
- Common attacker tradecraft observed
- Limited data prevents full confirmation

---

## Business Impact Assessment

Current Impact:
- No confirmed compromise
- No data loss detected
- No service disruption

Potential Impact:
- Malware execution
- Credential theft
- Lateral movement
- Data exfiltration

---

## Escalation Decision

Escalation Level: Tier 1 → Tier 2 SOC

Actions Taken:
- Endpoint flagged for monitoring
- Command-line activity documented
- Recommendation for deeper endpoint inspection

Actions Deferred:
- Full Incident Response activation
- Executive notification

---

## Recommended Mitigations

- Restrict PowerShell execution policies
- Enable PowerShell Script Block Logging
- Monitor encoded PowerShell command usage
- Review endpoint security baselines
- Apply application control where feasible

---

## What I Would Do Next in a Production Environment

1. Retrieve full EDR telemetry for the endpoint
2. Correlate with file creation, network, and registry events
3. Decode PowerShell command content
4. Search for similar executions across environment
5. Assess user account for credential compromise
6. Update detection rules for encoded PowerShell abuse

---

## SOC Analyst Value Demonstrated

This case demonstrates:
- Understanding of Windows attacker tradecraft
- EDR-style investigation methodology
- Command-line and process analysis
- Risk-based severity assignment
- Appropriate escalation judgment

---

## Final Assessment

This incident represents a realistic and common Windows-based threat scenario.
Correct handling balances caution with operational efficiency, preventing unnecessary escalation while ensuring readiness if malicious activity is confirmed.

